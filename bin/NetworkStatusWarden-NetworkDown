#!/bin/bash
#
# Short:    Do something when the primary network goes down
# Author:   Mark J Swift
# Version:  1.0.5
# Modified: 09-Jun-2018
#
# Called by NetworkStateWarden as follows:    
#   NetworkStatusWarden-NetworkDown <ServiceName> <InterfaceName>

# ---

# assume that all scripts are in a subdirectory off the main project directory
GLB_sv_ProjectDirPath="$(dirname $(dirname ${0}))"

# Include the CommonLib
. "${GLB_sv_ProjectDirPath}/inc/Common.sh"

# Exit if something went wrong unexpectedly
if test -z "${GLB_sv_ProjectName}"
then
  exit 90
fi

# ---

sv_PrimaryService="${1}"
sv_PrimaryInterface="${2}"

# ---

GLB_nf_logmessage ${GLB_iv_MsgLevelNotice} "Primary network service down - '${sv_PrimaryInterface}'"

if [ "${sv_PrimaryService}" = "unknown" ]
then
  say "Primary network service down"
else
  say "Primary network service down - $(echo "${sv_PrimaryInterface}" | sed "s|\(.\)|\1 |g")"
fi
